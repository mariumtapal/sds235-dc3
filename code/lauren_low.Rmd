---
title: "lauren_low"
output: html_document
---

```{r packages, include=FALSE}
library(tidyverse)
library(readxl)
library(here)
library(ggplot2)
```

```{r load-data, message=FALSE}
meteorological_data <- read_xlsx(here("data", "Sensor Data", "Meteorological Data.xlsx"))
sensor_data <- read_xlsx(here("data", "Sensor Data", "Sensor Data.xlsx"))
lekagul_sensor_data <- read_csv(here("data", "Traffic Data", "Lekagul Sensor Data.csv"))
```

```{r finding and visualizing most common vehicle types}
common_type <- lekagul_sensor_data %>%
  rename(type = "car-type") %>%
  group_by(type) %>%
  count(type)
common_type

common_vehicle_type <- ggplot(common_type, aes(x = reorder(type, -n), y = n)) +
  geom_bar(stat = "identity") +
  labs(title = "Most Common Vehicles Types in Boonsong Lekagul Nature Preserve", x = "Vehicle Type", y = "Number of Vehicles")
common_vehicle_type
```

```{r finding and visualizing most common vehicle id}
common_id <- lekagul_sensor_data %>%
  rename(id = "car-id") %>%
  count(id, sort = TRUE) %>%
  slice(1:10) %>%
  filter(rank(desc(n))>0)
common_id

common_vehicle_id <- ggplot(common_id, aes(x = reorder(id, -n), y = n))+
  geom_bar(stat = "identity") +
  labs(title = "Most Common Vehicles IDs in Boonsong Lekagul Nature Preserve", x = "Vehicle ID", y = "Number of Vehicles") + 
  theme(axis.text.x = element_text(angle = 270))
common_vehicle_id
```